# ğ•©â‰¢2â€¿nâ€¿2    ğ•¨â‰¢âŸ¨2â€¿k, kâŸ©
ColSegmentsCirclesâ† {
 câ€¿r â† ğ•¨ â‹„ r_sq â† Ã—Ëœr 
 F â† {âˆ¨Â´âˆ˜â¥ŠË˜ (r_sqâŠ¸â‰¥)â‰1 +ËÃ—Ëœ ğ•© -âŒœË˜ c}

 G â† { cacb â† ğ•© -âŒœË˜ c â‹„ ca â† âŠâ‰2 cacb â‹„ ab â† -Ëâ‰1 ğ•© 
          n â† (-âŒ¾âŠ)âˆ˜âŒ½ ab
          d_sq â† (Ã—Ëœ +Ë n Ã— ca) Ã· +ËÃ—Ëœ ab
          âˆ¨ËË˜(0 â‰¥ +Ë ca Ã— 1âŠâ‰2 cacb) âˆ§ r_sqâŠ¸â‰¥â‰1 d_sq}
 m â† Â¬F ğ•© â‹„ col â† (G m /â‰2 ğ•©)âŒ¾(mâŠ¸/) (1âŠ‘â‰¢ğ•©) â¥Š 1
}

# ---- Tests ----

points  â† [[âŸ¨-10, -8âŸ©, âŸ¨-10,  2âŸ©, âŸ¨-4, 4âŸ©, âŸ¨-2,  2âŸ©, âŸ¨-6, 10âŸ©, âŸ¨-6, -4âŸ©,
            âŸ¨ -4,  4âŸ©, âŸ¨ -2, -2âŸ©, âŸ¨ 0, 4âŸ©, âŸ¨ 0, 12âŸ©, âŸ¨ 6, 12âŸ©, âŸ¨-8, 10âŸ©],
	   [âŸ¨4, -6âŸ©, âŸ¨-2, -2âŸ©, âŸ¨-10, -6âŸ©, âŸ¨0, -8âŸ©,âŸ¨ 2, -2âŸ©,âŸ¨  8,  6âŸ©,
            âŸ¨4,  2âŸ©, âŸ¨ 2,  6âŸ©, âŸ¨  4,  8âŸ©, âŸ¨8,  8âŸ©,âŸ¨10, -2âŸ©,âŸ¨-10, 10âŸ© ]]
	   
circle_centers â† [âŸ¨-4,  6, 8,   2,  -6âŸ©,
                  âŸ¨-4, -4, 4,   2,   6âŸ©]
radius         â† âŸ¨  4,  2, 4, 1.2, 1.2âŸ©

expected â† 0â€¿1â€¿0â€¿1â€¿0â€¿0â€¿1â€¿0â€¿0â€¿1â€¿1â€¿1
test_result â† âˆ§Â´ expected = âŸ¨(circle_centers), radiusâŸ© ColSegmentsCircles points

# ---- Benchmark ----

Benchmark â† {
  n â† ğ•© â‹„ k â† ğ•¨
  points  â†© 10 Ã— 2â€¿nâ€¿2 â€¢rand.Range 0
  circle_centers â†© 10 Ã— 2â€¿k â€¢rand.Range 0
  radius â†© 10 Ã— k â€¢rand.Range 0
   
  1000 âŸ¨circle_centers, radiusâŸ©âŠ¸ColSegmentsCirclesâ€¢_timed points
}

benchmark_res â† 5â€¿50 BenchmarkâŒœ  10â€¿1000
